<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DuckDB Sudan Extension — Unified SQL for Sudan's Data</title>
    <meta name="description" content="Query Sudan's humanitarian, development, and geospatial data from 5 international APIs using SQL in DuckDB.">

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&family=Noto+Kufi+Arabic:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        /* ===== CSS Variables ===== */
        :root {
            --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            --font-mono: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
            --font-arabic: 'Noto Kufi Arabic', 'Inter', sans-serif;
            --radius: 12px;
            --radius-sm: 8px;
            --transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        [data-theme="dark"] {
            --bg-primary: #0b0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2235;
            --bg-code: #0d1117;
            --bg-hover: #1e293b;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --accent: #fbbf24;
            --accent-glow: rgba(251, 191, 36, 0.15);
            --link: #60a5fa;
            --green: #34d399;
            --red: #f87171;
            --orange: #fb923c;
            --purple: #a78bfa;
            --cyan: #22d3ee;
            --border: #1e293b;
            --border-hover: #334155;
            --shadow: 0 4px 24px rgba(0,0,0,0.3);
            --code-kw: #c792ea;
            --code-str: #c3e88d;
            --code-fn: #82aaff;
            --code-cm: #546e7a;
            --code-num: #f78c6c;
            --glass: rgba(17, 24, 39, 0.8);
        }

        [data-theme="light"] {
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --bg-card: #ffffff;
            --bg-code: #f1f5f9;
            --bg-hover: #f1f5f9;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #94a3b8;
            --accent: #d97706;
            --accent-glow: rgba(217, 119, 6, 0.1);
            --link: #2563eb;
            --green: #059669;
            --red: #dc2626;
            --orange: #ea580c;
            --purple: #7c3aed;
            --cyan: #0891b2;
            --border: #e2e8f0;
            --border-hover: #cbd5e1;
            --shadow: 0 4px 24px rgba(0,0,0,0.08);
            --code-kw: #8b5cf6;
            --code-str: #059669;
            --code-fn: #2563eb;
            --code-cm: #94a3b8;
            --code-num: #ea580c;
            --glass: rgba(255, 255, 255, 0.9);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: var(--font-sans);
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.7;
            transition: background var(--transition), color var(--transition);
        }

        [data-lang="ar"] .ar-text { display: inline; }
        [data-lang="ar"] .en-text { display: none; }
        [data-lang="en"] .ar-text { display: none; }
        [data-lang="en"] .en-text { display: inline; }
        [data-lang="ar"] .ar-block { display: block; }
        [data-lang="ar"] .en-block { display: none; }
        [data-lang="en"] .ar-block { display: none; }
        [data-lang="en"] .en-block { display: block; }
        [data-lang="ar"] { direction: rtl; }
        [data-lang="ar"] header, [data-lang="ar"] .hero, [data-lang="ar"] .section { direction: rtl; }
        [data-lang="ar"] .code-block, [data-lang="ar"] code { direction: ltr; text-align: left; }

        /* ===== Toast ===== */
        .toast-container {
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .toast {
            background: var(--bg-card);
            border: 1px solid var(--green);
            color: var(--green);
            padding: 0.6rem 1.2rem;
            border-radius: var(--radius-sm);
            font-size: 0.85rem;
            font-weight: 500;
            box-shadow: var(--shadow);
            animation: slideIn 0.3s ease, fadeOut 0.3s ease 2s forwards;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        @keyframes slideIn { from { transform: translateX(100px); opacity: 0; } }
        @keyframes fadeOut { to { transform: translateY(-10px); opacity: 0; } }

        /* ===== Header ===== */
        header {
            background: var(--glass);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border);
            padding: 0 2rem;
            height: 56px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
            direction: ltr;
        }

        .logo { display: flex; align-items: center; gap: 0.6rem; text-decoration: none; }
        .logo-icon {
            width: 30px; height: 30px; background: var(--accent); border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
            font-weight: 900; font-size: 14px; color: #0b0f1a;
        }
        .logo-text { font-size: 1.05rem; font-weight: 700; color: var(--text-primary); }
        .logo-text span { color: var(--accent); }

        .header-right { display: flex; align-items: center; gap: 0.5rem; }

        .header-btn {
            background: none; border: 1px solid var(--border); color: var(--text-secondary);
            padding: 0.35rem 0.7rem; border-radius: 6px; cursor: pointer; font-size: 0.8rem;
            font-family: var(--font-sans); transition: all var(--transition); display: flex; align-items: center; gap: 0.3rem;
        }
        .header-btn:hover { border-color: var(--accent); color: var(--accent); }

        nav { display: flex; align-items: center; gap: 0.3rem; }
        nav a {
            color: var(--text-secondary); text-decoration: none; padding: 0.35rem 0.7rem;
            border-radius: 6px; font-size: 0.85rem; transition: all var(--transition);
        }
        nav a:hover { color: var(--accent); background: var(--accent-glow); }

        /* ===== Search Modal ===== */
        .search-overlay {
            display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.6);
            backdrop-filter: blur(4px); z-index: 200; align-items: flex-start; justify-content: center;
            padding-top: 15vh;
        }
        .search-overlay.active { display: flex; }
        .search-box {
            background: var(--bg-secondary); border: 1px solid var(--border); border-radius: var(--radius);
            width: 90%; max-width: 600px; overflow: hidden; box-shadow: var(--shadow);
        }
        .search-input {
            width: 100%; padding: 1rem 1.2rem; background: none; border: none;
            color: var(--text-primary); font-size: 1.05rem; font-family: var(--font-sans); outline: none;
            border-bottom: 1px solid var(--border);
        }
        .search-input::placeholder { color: var(--text-muted); }
        .search-results { max-height: 400px; overflow-y: auto; padding: 0.5rem; }
        .search-item {
            padding: 0.6rem 0.8rem; border-radius: 6px; cursor: pointer;
            display: flex; align-items: center; gap: 0.6rem; transition: background var(--transition);
        }
        .search-item:hover { background: var(--bg-hover); }
        .search-item .fn-name { color: var(--code-fn); font-family: var(--font-mono); font-size: 0.9rem; }
        .search-item .fn-desc { color: var(--text-muted); font-size: 0.8rem; }
        .search-item .fn-tag {
            margin-left: auto; font-size: 0.7rem; padding: 0.15rem 0.5rem; border-radius: 4px;
            background: var(--accent-glow); color: var(--accent); font-weight: 600;
        }
        .search-empty { padding: 2rem; text-align: center; color: var(--text-muted); }

        /* ===== Hero ===== */
        .hero {
            padding: 5rem 2rem 3rem;
            text-align: center;
            position: relative;
            overflow: hidden;
            direction: ltr;
        }

        .hero::before {
            content: ''; position: absolute; inset: 0;
            background: radial-gradient(ellipse at 50% 0%, var(--accent-glow) 0%, transparent 60%);
            pointer-events: none;
        }

        .hero h1 {
            font-size: 3.2rem; font-weight: 900; letter-spacing: -0.03em;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent) 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            background-clip: text; margin-bottom: 1rem; position: relative;
        }

        .hero .subtitle {
            font-size: 1.2rem; color: var(--text-secondary); max-width: 700px;
            margin: 0 auto 2.5rem; line-height: 1.8;
        }

        /* Counters */
        .counters {
            display: flex; justify-content: center; gap: 2rem; flex-wrap: wrap;
            margin-bottom: 2.5rem; position: relative;
        }

        .counter-card {
            background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius);
            padding: 1.5rem 2rem; min-width: 160px; transition: all var(--transition);
        }
        .counter-card:hover { border-color: var(--accent); transform: translateY(-2px); box-shadow: var(--shadow); }

        .counter-value {
            font-size: 2.2rem; font-weight: 800; color: var(--accent);
            font-variant-numeric: tabular-nums;
        }
        .counter-label { font-size: 0.8rem; color: var(--text-muted); margin-top: 0.2rem; font-weight: 500; }

        /* Install box */
        .install-box {
            display: inline-block; background: var(--bg-code); border: 1px solid var(--border);
            border-radius: var(--radius); padding: 1rem 1.5rem; font-family: var(--font-mono);
            font-size: 0.95rem; position: relative; text-align: left;
        }

        /* ===== Sections ===== */
        .section {
            max-width: 1100px; margin: 0 auto; padding: 3rem 2rem;
            direction: ltr;
        }

        .section-header {
            text-align: center; margin-bottom: 2.5rem;
        }

        .section-header h2 {
            font-size: 2rem; font-weight: 800; margin-bottom: 0.5rem;
            letter-spacing: -0.02em;
        }

        .section-header p { color: var(--text-secondary); max-width: 600px; margin: 0 auto; }

        .divider {
            width: 60px; height: 3px; background: var(--accent); border-radius: 2px;
            margin: 0 auto 1rem;
        }

        /* ===== Provider Cards ===== */
        .providers-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.2rem; margin: 2rem 0;
        }

        .provider-card {
            background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius);
            padding: 1.5rem; transition: all var(--transition); position: relative; overflow: hidden;
        }
        .provider-card:hover { border-color: var(--accent); transform: translateY(-2px); box-shadow: var(--shadow); }

        .provider-card .status-dot {
            width: 8px; height: 8px; border-radius: 50%; display: inline-block;
            margin-right: 0.4rem; animation: pulse 2s infinite;
        }
        .status-dot.online { background: var(--green); }
        .status-dot.offline { background: var(--red); }
        .status-dot.checking { background: var(--text-muted); }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }

        .provider-card h3 { font-size: 1.05rem; font-weight: 700; margin-bottom: 0.15rem; }
        .provider-card .arabic-name {
            color: var(--accent); font-size: 0.88rem; font-family: var(--font-arabic);
            margin-bottom: 0.5rem; direction: rtl; display: block; text-align: right;
        }
        .provider-card p { color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 0.6rem; }
        .provider-card code { font-size: 0.82rem; }

        /* ===== Charts ===== */
        .charts-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 1.5rem; margin: 2rem 0;
        }
        .chart-card {
            background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius);
            padding: 1.5rem; transition: border-color var(--transition);
        }
        .chart-card:hover { border-color: var(--border-hover); }
        .chart-card h3 { font-size: 0.95rem; font-weight: 600; margin-bottom: 1rem; }
        .chart-card canvas { width: 100% !important; }

        /* ===== Map ===== */
        .map-container {
            background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius);
            overflow: hidden; margin: 2rem 0; height: 500px; position: relative;
        }
        #sudan-map { height: 100%; width: 100%; }

        /* ===== SQL Playground ===== */
        .playground {
            background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius);
            overflow: hidden; margin: 2rem 0;
        }
        .playground-header {
            display: flex; align-items: center; justify-content: space-between;
            padding: 0.8rem 1.2rem; border-bottom: 1px solid var(--border);
            background: var(--bg-secondary);
        }
        .playground-header span { font-size: 0.85rem; font-weight: 600; }
        .playground-tabs { display: flex; gap: 0.3rem; }
        .playground-tab {
            padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.78rem;
            cursor: pointer; border: 1px solid var(--border); background: none;
            color: var(--text-secondary); font-family: var(--font-sans); transition: all var(--transition);
        }
        .playground-tab.active { background: var(--accent); color: #0b0f1a; border-color: var(--accent); font-weight: 600; }
        .playground-editor {
            padding: 1.2rem 1.5rem; font-family: var(--font-mono); font-size: 0.88rem;
            min-height: 120px; background: var(--bg-code); border-bottom: 1px solid var(--border);
        }
        .playground-result {
            padding: 1rem 1.5rem; font-family: var(--font-mono); font-size: 0.82rem;
            max-height: 300px; overflow: auto; color: var(--text-secondary);
        }
        .playground-result table { width: 100%; font-size: 0.82rem; }
        .playground-result th {
            text-align: left; padding: 0.4rem 0.8rem; border-bottom: 2px solid var(--border);
            color: var(--text-primary); font-weight: 600;
        }
        .playground-result td { padding: 0.35rem 0.8rem; border-bottom: 1px solid var(--border); }
        .run-btn {
            background: var(--green); color: #0b0f1a; border: none; padding: 0.35rem 1rem;
            border-radius: 6px; font-size: 0.8rem; font-weight: 600; cursor: pointer;
            font-family: var(--font-sans); transition: all var(--transition);
        }
        .run-btn:hover { filter: brightness(1.1); }

        /* ===== Code Blocks ===== */
        .code-block {
            background: var(--bg-code); border: 1px solid var(--border); border-radius: var(--radius-sm);
            padding: 1.2rem 1.5rem; margin: 1rem 0 1.5rem; overflow-x: auto;
            position: relative; font-size: 0.88rem;
        }
        .code-block code { font-family: var(--font-mono); line-height: 1.7; white-space: pre; }
        .copy-btn {
            position: absolute; top: 0.6rem; right: 0.6rem; background: var(--bg-card);
            border: 1px solid var(--border); color: var(--text-secondary); padding: 0.3rem 0.6rem;
            border-radius: 6px; cursor: pointer; font-size: 0.75rem; transition: all var(--transition);
            font-family: var(--font-sans);
        }
        .copy-btn:hover { border-color: var(--accent); color: var(--accent); }
        .kw { color: var(--code-kw); } .fn { color: var(--code-fn); } .str { color: var(--code-str); }
        .cm { color: var(--code-cm); } .num { color: var(--code-num); }

        code {
            font-family: var(--font-mono); background: var(--bg-code); padding: 0.15rem 0.4rem;
            border-radius: 4px; font-size: 0.85em; border: 1px solid var(--border);
        }

        /* ===== Functions Table ===== */
        .fn-table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; font-size: 0.9rem; }
        .fn-table th {
            background: var(--bg-card); padding: 0.7rem 1rem; text-align: left; font-weight: 600;
            border-bottom: 2px solid var(--border);
        }
        .fn-table td { padding: 0.6rem 1rem; border-bottom: 1px solid var(--border); color: var(--text-secondary); }
        .fn-table tr:hover td { background: var(--bg-hover); }
        .fn-table td code { color: var(--code-fn); background: rgba(96, 165, 250, 0.08); border-color: rgba(96, 165, 250, 0.15); }
        .fn-tag {
            font-size: 0.7rem; padding: 0.12rem 0.45rem; border-radius: 4px; font-weight: 600;
        }
        .fn-tag.table { background: rgba(52, 211, 153, 0.1); color: var(--green); }
        .fn-tag.scalar { background: rgba(167, 139, 250, 0.1); color: var(--purple); }

        /* ===== Countries Grid ===== */
        .countries-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 0.6rem; margin: 1.5rem 0;
        }
        .country-item {
            display: flex; align-items: center; gap: 0.6rem; padding: 0.6rem 1rem;
            background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius-sm);
            transition: border-color var(--transition);
        }
        .country-item:hover { border-color: var(--accent); }
        .country-item .iso { color: var(--accent); font-weight: 700; font-family: var(--font-mono); min-width: 2.5rem; }
        .country-item .ar { color: var(--text-muted); margin-left: auto; font-family: var(--font-arabic); direction: rtl; }

        /* ===== Notebook Cards ===== */
        .notebooks-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(460px, 1fr));
            gap: 1.5rem; margin: 2rem 0;
        }
        .notebook-card {
            background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius);
            overflow: hidden; transition: all var(--transition); display: flex; flex-direction: column;
        }
        .notebook-card:hover { border-color: var(--accent); transform: translateY(-3px); box-shadow: var(--shadow); }
        .notebook-preview {
            height: 180px; position: relative; overflow: hidden;
            display: flex; align-items: center; justify-content: center;
        }
        .notebook-preview .nb-icon {
            font-size: 3.5rem; opacity: 0.15; position: absolute;
        }
        .notebook-preview .nb-tags {
            position: absolute; top: 0.8rem; left: 0.8rem; display: flex; gap: 0.4rem; flex-wrap: wrap;
        }
        .nb-tag {
            font-size: 0.65rem; padding: 0.2rem 0.55rem; border-radius: 4px; font-weight: 600;
            text-transform: uppercase; letter-spacing: 0.03em;
        }
        .nb-tag.sql { background: rgba(96, 165, 250, 0.15); color: var(--link); }
        .nb-tag.geo { background: rgba(52, 211, 153, 0.15); color: var(--green); }
        .nb-tag.plotly { background: rgba(167, 139, 250, 0.15); color: var(--purple); }
        .nb-tag.folium { background: rgba(251, 191, 36, 0.15); color: var(--accent); }
        .nb-tag.beginner { background: rgba(34, 211, 238, 0.15); color: var(--cyan); }
        .nb-tag.advanced { background: rgba(248, 113, 113, 0.15); color: var(--red); }
        .notebook-preview .nb-visual {
            display: flex; gap: 0.5rem; align-items: center; z-index: 1;
        }
        .nb-cell {
            background: var(--bg-code); border: 1px solid var(--border); border-radius: 6px;
            padding: 0.5rem 0.8rem; font-family: var(--font-mono); font-size: 0.7rem;
            color: var(--text-muted); max-width: 200px; white-space: nowrap; overflow: hidden;
            text-overflow: ellipsis;
        }
        .notebook-body { padding: 1.2rem 1.5rem; flex: 1; display: flex; flex-direction: column; }
        .notebook-body h3 { font-size: 1.1rem; font-weight: 700; margin-bottom: 0.3rem; }
        .notebook-body .nb-arabic {
            color: var(--accent); font-family: var(--font-arabic); font-size: 0.88rem;
            direction: rtl; display: block; text-align: right; margin-bottom: 0.5rem;
        }
        .notebook-body p { color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 1rem; flex: 1; }
        .notebook-body .nb-meta {
            display: flex; gap: 1.2rem; font-size: 0.75rem; color: var(--text-muted);
            margin-bottom: 1rem; flex-wrap: wrap;
        }
        .notebook-body .nb-meta span { display: flex; align-items: center; gap: 0.3rem; }
        .notebook-actions { display: flex; gap: 0.6rem; flex-wrap: wrap; }
        .colab-btn {
            display: inline-flex; align-items: center; gap: 0.5rem;
            background: linear-gradient(135deg, #F9AB00, #E37400); color: #0b0f1a;
            padding: 0.5rem 1.2rem; border-radius: 8px; text-decoration: none;
            font-size: 0.82rem; font-weight: 700; font-family: var(--font-sans);
            transition: all var(--transition); border: none; cursor: pointer;
        }
        .colab-btn:hover { filter: brightness(1.1); transform: translateY(-1px); }
        .colab-btn svg { width: 18px; height: 18px; }
        .github-nb-btn {
            display: inline-flex; align-items: center; gap: 0.4rem;
            background: none; border: 1px solid var(--border); color: var(--text-secondary);
            padding: 0.5rem 1rem; border-radius: 8px; text-decoration: none;
            font-size: 0.82rem; font-weight: 500; font-family: var(--font-sans);
            transition: all var(--transition);
        }
        .github-nb-btn:hover { border-color: var(--accent); color: var(--accent); }

        @media (max-width: 768px) {
            .notebooks-grid { grid-template-columns: 1fr; }
            .notebook-preview { height: 140px; }
        }

        /* ===== Changelog ===== */
        .timeline { position: relative; padding-left: 2rem; }
        .timeline::before {
            content: ''; position: absolute; left: 0.5rem; top: 0; bottom: 0;
            width: 2px; background: var(--border);
        }
        .timeline-item { position: relative; margin-bottom: 2rem; }
        .timeline-item::before {
            content: ''; position: absolute; left: -1.65rem; top: 0.4rem;
            width: 10px; height: 10px; border-radius: 50%; background: var(--accent);
            border: 2px solid var(--bg-primary);
        }
        .timeline-item h4 { font-size: 1rem; font-weight: 700; margin-bottom: 0.2rem; }
        .timeline-item .date { color: var(--text-muted); font-size: 0.8rem; margin-bottom: 0.4rem; }
        .timeline-item p { color: var(--text-secondary); font-size: 0.88rem; }
        .timeline-item ul { color: var(--text-secondary); font-size: 0.88rem; padding-left: 1.2rem; }
        .timeline-item li { margin-bottom: 0.2rem; }

        /* ===== Footer ===== */
        footer {
            border-top: 1px solid var(--border); padding: 3rem 2rem; text-align: center;
            color: var(--text-muted); font-size: 0.85rem;
        }
        footer a { color: var(--text-secondary); text-decoration: none; }
        footer a:hover { color: var(--accent); }
        .footer-links { display: flex; justify-content: center; gap: 1.5rem; margin-bottom: 1rem; }

        /* ===== Responsive ===== */
        @media (max-width: 768px) {
            .hero h1 { font-size: 2rem; }
            .counters { gap: 0.8rem; }
            .counter-card { min-width: 130px; padding: 1rem; }
            .counter-value { font-size: 1.6rem; }
            .charts-grid { grid-template-columns: 1fr; }
            .providers-grid { grid-template-columns: 1fr; }
            .section { padding: 2rem 1rem; }
            header { padding: 0 1rem; }
            nav { display: none; }
            .map-container { height: 350px; }
        }

        /* ===== Smooth scroll ===== */
        html { scroll-behavior: smooth; }

        /* ===== Scrollbar ===== */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-primary); }
        ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--text-muted); }
    </style>
</head>
<body data-lang="en">

<!-- Toast Container -->
<div class="toast-container" id="toasts"></div>

<!-- Search Modal -->
<div class="search-overlay" id="searchOverlay" onclick="if(event.target===this)closeSearch()">
    <div class="search-box">
        <input type="text" class="search-input" id="searchInput" placeholder="Search functions... (Ctrl+K)" oninput="filterSearch(this.value)">
        <div class="search-results" id="searchResults"></div>
    </div>
</div>

<!-- Header -->
<header>
    <a href="#" class="logo">
        <div class="logo-icon">S</div>
        <div class="logo-text">DuckDB <span>Sudan</span></div>
    </a>
    <nav>
        <a href="#providers">Providers</a>
        <a href="#dashboard">Dashboard</a>
        <a href="#map">Map</a>
        <a href="#playground">Playground</a>
        <a href="#functions">Functions</a>
        <a href="#notebooks">Notebooks</a>
    </nav>
    <div class="header-right">
        <button class="header-btn" onclick="openSearch()" title="Ctrl+K">&#x1F50D; Search</button>
        <button class="header-btn" onclick="toggleLang()" id="langBtn" title="Toggle Arabic/English">AR</button>
        <button class="header-btn" onclick="toggleTheme()" id="themeBtn" title="Toggle theme">&#x263E;</button>
        <a href="https://github.com/Osman-Geomatics93/duckdb-sudan-" target="_blank" class="header-btn">GitHub</a>
    </div>
</header>

<!-- Hero -->
<section class="hero">
    <h1>
        <span class="en-text">DuckDB Sudan Extension</span>
        <span class="ar-text" style="font-family:var(--font-arabic)">إضافة DuckDB للسودان</span>
    </h1>
    <p class="subtitle">
        <span class="en-text">Unified SQL access to Sudan's humanitarian, development, and geospatial data from 5 international APIs.</span>
        <span class="ar-text" style="font-family:var(--font-arabic)">وصول موحد عبر SQL لبيانات السودان الإنسانية والتنموية والجغرافية من 5 واجهات برمجة دولية.</span>
    </p>

    <!-- Animated Counters -->
    <div class="counters">
        <div class="counter-card">
            <div class="counter-value" data-target="50448963" data-format="pop">0</div>
            <div class="counter-label">
                <span class="en-text">Population (2024)</span>
                <span class="ar-text" style="font-family:var(--font-arabic)">عدد السكان</span>
            </div>
        </div>
        <div class="counter-card">
            <div class="counter-value" data-target="2466231" data-format="num">0</div>
            <div class="counter-label">
                <span class="en-text">Refugees (2025)</span>
                <span class="ar-text" style="font-family:var(--font-arabic)">لاجئون</span>
            </div>
        </div>
        <div class="counter-card">
            <div class="counter-value" data-target="18" data-format="raw">0</div>
            <div class="counter-label">
                <span class="en-text">States</span>
                <span class="ar-text" style="font-family:var(--font-arabic)">ولاية</span>
            </div>
        </div>
        <div class="counter-card">
            <div class="counter-value" data-target="5" data-format="raw">0</div>
            <div class="counter-label">
                <span class="en-text">APIs</span>
                <span class="ar-text" style="font-family:var(--font-arabic)">واجهات برمجة</span>
            </div>
        </div>
        <div class="counter-card">
            <div class="counter-value" data-target="12" data-format="raw">0</div>
            <div class="counter-label">
                <span class="en-text">SQL Functions</span>
                <span class="ar-text" style="font-family:var(--font-arabic)">دوال SQL</span>
            </div>
        </div>
    </div>

    <!-- Install -->
    <div class="install-box">
        <div style="font-size:0.7rem;color:var(--accent);font-weight:600;margin-bottom:0.5rem;letter-spacing:0.05em;text-transform:uppercase">
            <span class="en-text">Install — DuckDB v1.4.4+ (Windows)</span>
            <span class="ar-text" style="font-family:var(--font-arabic)">التثبيت — DuckDB v1.4.4+ (ويندوز)</span>
        </div>
        <code><span class="cm">-- Enable HTTPS downloads</span>
<span class="kw">INSTALL</span> httpfs; <span class="kw">LOAD</span> httpfs;

<span class="cm">-- Set the custom extension repository</span>
<span class="kw">SET</span> custom_extension_repository = <span class="str">'https://osman-geomatics93.github.io/duckdb-sudan-'</span>;

<span class="cm">-- Install and load</span>
<span class="kw">INSTALL</span> sudan;
<span class="kw">LOAD</span> sudan;</code>
        <button class="copy-btn" onclick="copyCode(this)" style="top:0.5rem;right:0.5rem">Copy</button>
    </div>
    <div style="display:flex;gap:0.5rem;margin-top:0.75rem;flex-wrap:wrap">
        <div class="install-box" style="flex:1;min-width:250px">
            <div style="font-size:0.65rem;color:var(--text-muted);font-weight:600;margin-bottom:0.4rem;letter-spacing:0.05em;text-transform:uppercase">
                <span class="en-text">Alternative — Build from source</span>
                <span class="ar-text" style="font-family:var(--font-arabic)">بديل — البناء من المصدر</span>
            </div>
            <code style="font-size:0.78rem">git clone --recurse-submodules https://github.com/Osman-Geomatics93/duckdb-sudan-.git
cd duckdb-sudan-
build_release.bat
build\release\duckdb.exe -unsigned</code>
            <button class="copy-btn" onclick="copyCode(this)" style="top:0.3rem;right:0.3rem;font-size:0.7rem">Copy</button>
        </div>
        <div class="install-box" style="flex:1;min-width:250px;opacity:0.5">
            <div style="font-size:0.65rem;color:var(--text-muted);font-weight:600;margin-bottom:0.4rem;letter-spacing:0.05em;text-transform:uppercase">
                <span class="en-text">Coming soon — Community registry</span>
                <span class="ar-text" style="font-family:var(--font-arabic)">قريباً — سجل المجتمع</span>
            </div>
            <code style="font-size:0.78rem"><span class="kw">INSTALL</span> sudan <span class="kw">FROM</span> community;
<span class="kw">LOAD</span> sudan;</code>
            <button class="copy-btn" onclick="copyCode(this)" style="top:0.3rem;right:0.3rem;font-size:0.7rem">Copy</button>
        </div>
    </div>
</section>

<!-- Providers -->
<section class="section" id="providers">
    <div class="section-header">
        <div class="divider"></div>
        <h2>
            <span class="en-text">Data Providers</span>
            <span class="ar-text" style="font-family:var(--font-arabic)">مزودو البيانات</span>
        </h2>
        <p>
            <span class="en-text">Live connections to 5 international APIs. Green dot = API reachable.</span>
            <span class="ar-text" style="font-family:var(--font-arabic)">اتصالات مباشرة بـ 5 واجهات برمجة دولية. النقطة الخضراء = API متاح.</span>
        </p>
    </div>

    <div class="providers-grid">
        <div class="provider-card" data-url="https://api.worldbank.org/v2/country/SDN?format=json">
            <h3><span class="status-dot checking" id="status-wb"></span> World Bank</h3>
            <span class="arabic-name">البنك الدولي</span>
            <p>Development indicators, GDP, population, education</p>
            <code>SUDAN_WorldBank('SP.POP.TOTL')</code>
        </div>
        <div class="provider-card" data-url="https://ghoapi.azureedge.net/api/WHOSIS_000001?$top=1">
            <h3><span class="status-dot checking" id="status-who"></span> World Health Organization</h3>
            <span class="arabic-name">منظمة الصحة العالمية</span>
            <p>Health indicators, disease burden, mortality rates</p>
            <code>SUDAN_WHO('MDG_0000000026')</code>
        </div>
        <div class="provider-card" data-url="https://faostatservices.fao.org/api/v1/en/data/QCL?area=276&limit=1">
            <h3><span class="status-dot checking" id="status-fao"></span> FAO</h3>
            <span class="arabic-name">منظمة الأغذية والزراعة</span>
            <p>Agricultural production, food security, land use</p>
            <code>SUDAN_FAO('QCL', 'production')</code>
        </div>
        <div class="provider-card" data-url="https://api.unhcr.org/population/v1/population/?limit=1&coo=SDN&cf_type=iso">
            <h3><span class="status-dot checking" id="status-unhcr"></span> UNHCR</h3>
            <span class="arabic-name">المفوضية السامية</span>
            <p>Refugees, IDPs, asylum seekers, displacement data</p>
            <code>SUDAN_UNHCR('refugees')</code>
        </div>
        <div class="provider-card" data-url="https://sdmx.ilo.org/rest/data/ILO,DF_UNE_DEAP_SEX_AGE_RT/SDN.A...?format=jsondata&lastNObservations=1">
            <h3><span class="status-dot checking" id="status-ilo"></span> ILO</h3>
            <span class="arabic-name">منظمة العمل الدولية</span>
            <p>Employment, labor force, unemployment statistics</p>
            <code>SUDAN_ILO('UNE_DEAP_SEX_AGE_RT')</code>
        </div>
    </div>
</section>

<!-- Dashboard -->
<section class="section" id="dashboard">
    <div class="section-header">
        <div class="divider"></div>
        <h2>
            <span class="en-text">Live Data Dashboard</span>
            <span class="ar-text" style="font-family:var(--font-arabic)">لوحة البيانات</span>
        </h2>
        <p>
            <span class="en-text">Real data from Sudan's APIs, accessible through simple SQL queries.</span>
            <span class="ar-text" style="font-family:var(--font-arabic)">بيانات حقيقية من واجهات برمجة السودان.</span>
        </p>
    </div>

    <div class="charts-grid">
        <div class="chart-card">
            <h3>Sudan Population Growth (World Bank)</h3>
            <canvas id="popChart" height="250"></canvas>
        </div>
        <div class="chart-card">
            <h3>Sudanese Refugees Worldwide (UNHCR)</h3>
            <canvas id="refugeeChart" height="250"></canvas>
        </div>
        <div class="chart-card">
            <h3>Maternal Mortality Ratio (WHO)</h3>
            <canvas id="mortalityChart" height="250"></canvas>
        </div>
        <div class="chart-card">
            <h3>Regional Population Comparison 2024</h3>
            <canvas id="compareChart" height="250"></canvas>
        </div>
    </div>
</section>

<!-- Map -->
<section class="section" id="map">
    <div class="section-header">
        <div class="divider"></div>
        <h2>
            <span class="en-text">Interactive Map — Sudan's 18 States</span>
            <span class="ar-text" style="font-family:var(--font-arabic)">خريطة تفاعلية — 18 ولاية سودانية</span>
        </h2>
        <p>
            <span class="en-text">Real polygon boundaries from <a href="https://gadm.org/" target="_blank" style="color:var(--link)">GADM v4.1</a> embedded as MultiPolygon GeoJSON. Click a state for details.</span>
            <span class="ar-text" style="font-family:var(--font-arabic)">حدود مضلعات حقيقية من <a href="https://gadm.org/" target="_blank" style="color:var(--link)">GADM v4.1</a> مدمجة كـ MultiPolygon GeoJSON. انقر على ولاية للتفاصيل.</span>
        </p>
    </div>
    <div class="map-container">
        <div id="sudan-map"></div>
    </div>
</section>

<!-- SQL Playground -->
<section class="section" id="playground">
    <div class="section-header">
        <div class="divider"></div>
        <h2>
            <span class="en-text">SQL Playground</span>
            <span class="ar-text" style="font-family:var(--font-arabic)">ساحة SQL التجريبية</span>
        </h2>
        <p>
            <span class="en-text">Try example queries. Install the extension locally to run your own.</span>
            <span class="ar-text" style="font-family:var(--font-arabic)">جرب استعلامات المثال. ثبت الإضافة محلياً لتشغيل استعلاماتك.</span>
        </p>
    </div>

    <div class="playground">
        <div class="playground-header">
            <span>DuckDB SQL</span>
            <div style="display:flex;gap:0.5rem;align-items:center">
                <div class="playground-tabs">
                    <button class="playground-tab active" onclick="loadQuery(0,this)">Providers</button>
                    <button class="playground-tab" onclick="loadQuery(1,this)">Population</button>
                    <button class="playground-tab" onclick="loadQuery(2,this)">Refugees</button>
                    <button class="playground-tab" onclick="loadQuery(3,this)">States</button>
                </div>
                <button class="run-btn" onclick="runQuery()">&#9654; Run</button>
            </div>
        </div>
        <div class="playground-editor" id="pgEditor"></div>
        <div class="playground-result" id="pgResult"><span style="color:var(--text-muted)">Click "Run" to execute the query.</span></div>
    </div>
</section>

<!-- Functions Reference -->
<section class="section" id="functions">
    <div class="section-header">
        <div class="divider"></div>
        <h2>
            <span class="en-text">All SQL Functions</span>
            <span class="ar-text" style="font-family:var(--font-arabic)">جميع دوال SQL</span>
        </h2>
    </div>

    <h3>Discovery & Metadata</h3>
    <table class="fn-table">
        <thead><tr><th>Function</th><th>Type</th><th>Description</th></tr></thead>
        <tbody>
            <tr><td><code>SUDAN_Providers()</code></td><td><span class="fn-tag table">table</span></td><td>List all 5 data providers with Arabic names and URLs</td></tr>
            <tr><td><code>SUDAN_WB_Indicators(search)</code></td><td><span class="fn-tag table">table</span></td><td>Search World Bank indicators by keyword</td></tr>
            <tr><td><code>SUDAN_WHO_Indicators(search)</code></td><td><span class="fn-tag table">table</span></td><td>Search WHO GHO indicators by keyword</td></tr>
            <tr><td><code>SUDAN_Search(query)</code></td><td><span class="fn-tag table">table</span></td><td>Cross-provider indicator search</td></tr>
        </tbody>
    </table>

    <h3>Data Functions</h3>
    <table class="fn-table">
        <thead><tr><th>Function</th><th>Signature</th><th>Source</th></tr></thead>
        <tbody>
            <tr><td><code>SUDAN_WorldBank</code></td><td><code>(indicator, countries := ['SDN'])</code></td><td>World Bank V2 API</td></tr>
            <tr><td><code>SUDAN_WHO</code></td><td><code>(indicator, countries := ['SDN'])</code></td><td>WHO GHO OData API</td></tr>
            <tr><td><code>SUDAN_FAO</code></td><td><code>(dataset, element, countries := ['SDN'])</code></td><td>FAOSTAT API</td></tr>
            <tr><td><code>SUDAN_UNHCR</code></td><td><code>(population_type, countries := ['SDN'])</code></td><td>UNHCR Population API</td></tr>
            <tr><td><code>SUDAN_ILO</code></td><td><code>(indicator, countries := ['SDN'])</code></td><td>ILO SDMX API</td></tr>
        </tbody>
    </table>

    <h3>Geospatial Functions</h3>
    <table class="fn-table">
        <thead><tr><th>Function</th><th>Type</th><th>Description</th></tr></thead>
        <tbody>
            <tr><td><code>SUDAN_Boundaries(level)</code></td><td><span class="fn-tag table">table</span></td><td>Admin boundaries as MultiPolygon GeoJSON from GADM v4.1 ('country', 'state', 'locality')</td></tr>
            <tr><td><code>SUDAN_States()</code></td><td><span class="fn-tag table">table</span></td><td>18 states with bilingual names, ISO codes, centroids, and polygon boundaries</td></tr>
            <tr><td><code>SUDAN_GeoCode(name)</code></td><td><span class="fn-tag scalar">scalar</span></td><td>State name (Arabic or English) &rarr; ISO code</td></tr>
        </tbody>
    </table>
</section>

<!-- Countries -->
<section class="section" id="countries">
    <div class="section-header">
        <div class="divider"></div>
        <h2>
            <span class="en-text">Supported Countries</span>
            <span class="ar-text" style="font-family:var(--font-arabic)">الدول المدعومة</span>
        </h2>
        <p>
            <span class="en-text">All functions default to Sudan. Use the <code>countries</code> parameter for regional comparison.</span>
            <span class="ar-text" style="font-family:var(--font-arabic)">جميع الدوال تعمل افتراضياً للسودان. استخدم معامل <code>countries</code> للمقارنة الإقليمية.</span>
        </p>
    </div>
    <div class="countries-grid">
        <div class="country-item"><span class="iso">SDN</span><span>Sudan</span><span class="ar">السودان</span></div>
        <div class="country-item"><span class="iso">EGY</span><span>Egypt</span><span class="ar">مصر</span></div>
        <div class="country-item"><span class="iso">ETH</span><span>Ethiopia</span><span class="ar">إثيوبيا</span></div>
        <div class="country-item"><span class="iso">TCD</span><span>Chad</span><span class="ar">تشاد</span></div>
        <div class="country-item"><span class="iso">SSD</span><span>South Sudan</span><span class="ar">جنوب السودان</span></div>
        <div class="country-item"><span class="iso">ERI</span><span>Eritrea</span><span class="ar">إريتريا</span></div>
        <div class="country-item"><span class="iso">LBY</span><span>Libya</span><span class="ar">ليبيا</span></div>
        <div class="country-item"><span class="iso">CAF</span><span>Central African Rep.</span><span class="ar">أفريقيا الوسطى</span></div>
    </div>
</section>

<!-- Changelog -->
<section class="section" id="changelog">
    <div class="section-header">
        <div class="divider"></div>
        <h2>
            <span class="en-text">Changelog</span>
            <span class="ar-text" style="font-family:var(--font-arabic)">سجل التغييرات</span>
        </h2>
    </div>
    <div class="timeline">
        <div class="timeline-item">
            <h4>v0.1.1 — Real Polygon Boundaries</h4>
            <div class="date">February 2026</div>
            <ul>
                <li>Replaced Point centroids with real MultiPolygon boundaries from <a href="https://gadm.org/" style="color:var(--link)">GADM v4.1</a></li>
                <li><code>SUDAN_Boundaries('state')</code> now returns actual state polygons (780&ndash;53,852 chars each)</li>
                <li><code>SUDAN_Boundaries('country')</code> returns full country outline (103K chars)</li>
                <li><code>SUDAN_States()</code> geojson column now contains polygon boundaries</li>
                <li>Coordinates simplified to 3 decimal places (~111m accuracy)</li>
                <li>9 test cases with 52 assertions</li>
            </ul>
        </div>
        <div class="timeline-item">
            <h4>v0.1.0 — Initial Release</h4>
            <div class="date">February 2026</div>
            <ul>
                <li>12 SQL functions across 5 international APIs</li>
                <li>World Bank, WHO, FAO, UNHCR, ILO data providers</li>
                <li>Embedded GeoJSON boundaries for 18 Sudan states</li>
                <li>Bilingual support (Arabic/English)</li>
                <li>Regional comparison with 8 neighboring countries</li>
                <li>In-memory response caching</li>
            </ul>
        </div>
        <div class="timeline-item">
            <h4>Roadmap</h4>
            <div class="date">Upcoming</div>
            <ul>
                <li>DuckDB Community Extensions listing</li>
                <li>Locality-level boundaries (admin-2)</li>
                <li>Filter pushdown for year ranges</li>
                <li>Additional data providers (OCHA, HDX)</li>
            </ul>
        </div>
    </div>
</section>

<!-- Building -->
<section class="section" id="building">
    <div class="section-header">
        <div class="divider"></div>
        <h2>
            <span class="en-text">Building from Source</span>
            <span class="ar-text" style="font-family:var(--font-arabic)">البناء من المصدر</span>
        </h2>
    </div>

    <h3>Windows</h3>
    <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <code>git clone --recurse-submodules https://github.com/Osman-Geomatics93/duckdb-sudan-.git
cd duckdb-sudan-
build_release.bat
build\release\duckdb.exe -unsigned</code>
    </div>

    <h3>Linux / macOS</h3>
    <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
        <code>git clone --recurse-submodules https://github.com/Osman-Geomatics93/duckdb-sudan-.git
cd duckdb-sudan-
GEN=ninja make release
./build/release/duckdb -unsigned</code>
    </div>
</section>

<!-- Notebooks -->
<section class="section" id="notebooks">
    <div class="section-header">
        <div class="divider"></div>
        <h2>
            <span class="en-text">Interactive Notebooks</span>
            <span class="ar-text" style="font-family:var(--font-arabic)">دفاتر تفاعلية</span>
        </h2>
        <p>
            <span class="en-text">Learn SQL and explore Sudan's data interactively in Google Colab. No installation needed &mdash; click and start querying.</span>
            <span class="ar-text" style="font-family:var(--font-arabic)">تعلّم SQL واستكشف بيانات السودان تفاعلياً في Google Colab. بدون تثبيت &mdash; انقر وابدأ الاستعلام.</span>
        </p>
    </div>

    <div class="notebooks-grid">
        <!-- SQL Basics Notebook -->
        <div class="notebook-card">
            <div class="notebook-preview" style="background: linear-gradient(135deg, rgba(96,165,250,0.08) 0%, rgba(34,211,238,0.08) 100%);">
                <div class="nb-icon">&#128218;</div>
                <div class="nb-tags">
                    <span class="nb-tag sql">SQL</span>
                    <span class="nb-tag beginner">Beginner</span>
                </div>
                <div class="nb-visual">
                    <div class="nb-cell"><span style="color:var(--code-kw)">SELECT</span> * <span style="color:var(--code-kw)">FROM</span> <span style="color:var(--code-fn)">SUDAN_States</span>();</div>
                    <div style="color:var(--text-muted);font-size:1.2rem">&#8594;</div>
                    <div class="nb-cell" style="color:var(--green)">18 rows</div>
                </div>
            </div>
            <div class="notebook-body">
                <h3>
                    <span class="en-text">SQL Basics with Sudan Data</span>
                    <span class="ar-text" style="font-family:var(--font-arabic)">أساسيات SQL مع بيانات السودان</span>
                </h3>
                <span class="nb-arabic">تعلم SQL من الصفر باستخدام بيانات حقيقية</span>
                <p>
                    <span class="en-text">A hands-on SQL tutorial using real Sudan data. Covers SELECT, WHERE, JOIN, GROUP BY, HAVING, CASE, and geospatial queries &mdash; all powered by live API data from the extension.</span>
                    <span class="ar-text" style="font-family:var(--font-arabic)">دليل عملي لتعلم SQL باستخدام بيانات السودان الحقيقية. يغطي SELECT، WHERE، JOIN، GROUP BY، HAVING، CASE، والاستعلامات الجغرافية.</span>
                </p>
                <div class="nb-meta">
                    <span>&#128196; 70+ cells</span>
                    <span>&#9201; ~20 min</span>
                    <span>&#128205; jupysql magic</span>
                    <span>&#127760; DuckDB spatial</span>
                </div>
                <div class="notebook-actions">
                    <a href="https://colab.research.google.com/github/Osman-Geomatics93/duckdb-sudan-/blob/main/notebooks/sudan_sql_basics.ipynb" target="_blank" class="colab-btn">
                        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M16.94 2a7.06 7.06 0 0 0-4.87 2.08l-.17.19-.16-.18A7.06 7.06 0 0 0 6.87 2C3.05 2 0 5.18 0 9.12c0 4.49 3.89 8.15 9.79 13.7l.69.64a2 2 0 0 0 2.73 0l.68-.63C19.78 17.58 24 13.68 24 9.12 24 5.18 20.76 2 16.94 2z"/></svg>
                        Open in Colab
                    </a>
                    <a href="https://github.com/Osman-Geomatics93/duckdb-sudan-/blob/main/notebooks/sudan_sql_basics.ipynb" target="_blank" class="github-nb-btn">
                        &#128193; View on GitHub
                    </a>
                </div>
            </div>
        </div>

        <!-- Geospatial Analysis Notebook -->
        <div class="notebook-card">
            <div class="notebook-preview" style="background: linear-gradient(135deg, rgba(167,139,250,0.08) 0%, rgba(230,57,70,0.08) 100%);">
                <div class="nb-icon">&#127758;</div>
                <div class="nb-tags">
                    <span class="nb-tag geo">Geospatial</span>
                    <span class="nb-tag plotly">Plotly</span>
                    <span class="nb-tag folium">Folium</span>
                    <span class="nb-tag advanced">Advanced</span>
                </div>
                <div class="nb-visual">
                    <div class="nb-cell"><span style="color:var(--code-fn)">px.choropleth_mapbox</span>(gdf, ...)</div>
                    <div style="color:var(--text-muted);font-size:1.2rem">&#8594;</div>
                    <div class="nb-cell" style="color:var(--purple)">&#128506; dark map</div>
                </div>
            </div>
            <div class="notebook-body">
                <h3>
                    <span class="en-text">Geospatial Analysis Dashboard</span>
                    <span class="ar-text" style="font-family:var(--font-arabic)">لوحة التحليل الجغرافي المكاني</span>
                </h3>
                <span class="nb-arabic">خرائط تفاعلية ولوحات بيانات حديثة</span>
                <p>
                    <span class="en-text">13 interactive visualizations: choropleth maps, animated population race, refugee Sankey flows, regional sunburst, health dashboard, agriculture treemap, dark-themed Folium map with popups, radar charts, GDP gauges, and an executive dashboard.</span>
                    <span class="ar-text" style="font-family:var(--font-arabic)">13 رسماً تفاعلياً: خرائط حرارية، سباق سكاني متحرك، مخطط سانكي للاجئين، شمسي إقليمي، لوحة صحية، خريطة شجرية للزراعة، خريطة Folium داكنة، مخطط راداري، ولوحة تنفيذية.</span>
                </p>
                <div class="nb-meta">
                    <span>&#128202; 13 sections</span>
                    <span>&#128506; Plotly dark theme</span>
                    <span>&#127759; Folium multi-layer</span>
                    <span>&#128190; 5 export formats</span>
                </div>
                <div class="notebook-actions">
                    <a href="https://colab.research.google.com/github/Osman-Geomatics93/duckdb-sudan-/blob/main/notebooks/sudan_geospatial_analysis.ipynb" target="_blank" class="colab-btn">
                        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M16.94 2a7.06 7.06 0 0 0-4.87 2.08l-.17.19-.16-.18A7.06 7.06 0 0 0 6.87 2C3.05 2 0 5.18 0 9.12c0 4.49 3.89 8.15 9.79 13.7l.69.64a2 2 0 0 0 2.73 0l.68-.63C19.78 17.58 24 13.68 24 9.12 24 5.18 20.76 2 16.94 2z"/></svg>
                        Open in Colab
                    </a>
                    <a href="https://github.com/Osman-Geomatics93/duckdb-sudan-/blob/main/notebooks/sudan_geospatial_analysis.ipynb" target="_blank" class="github-nb-btn">
                        &#128193; View on GitHub
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Footer -->
<footer>
    <div class="footer-links">
        <a href="https://github.com/Osman-Geomatics93/duckdb-sudan-">GitHub</a>
        <a href="https://duckdb.org">DuckDB</a>
        <a href="functions.md">Function Reference</a>
        <a href="https://github.com/Osman-Geomatics93/duckdb-sudan-/issues">Issues</a>
    </div>
    <p>Built on <a href="https://duckdb.org">DuckDB</a> &middot; Data from <a href="https://data.worldbank.org/">World Bank</a>, <a href="https://www.who.int/data/gho">WHO</a>, <a href="https://www.fao.org/faostat/">FAO</a>, <a href="https://www.unhcr.org/refugee-statistics/">UNHCR</a>, <a href="https://ilostat.ilo.org/">ILO</a>, <a href="https://gadm.org/">GADM</a></p>
    <p style="margin-top:0.5rem">&copy; 2025 <a href="https://github.com/Osman-Geomatics93">Osman-Geomatics93</a> &middot; MIT License</p>
</footer>

<!-- Libraries -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

<script>
// ===== Toast Notifications =====
function showToast(msg) {
    const c = document.getElementById('toasts');
    const t = document.createElement('div');
    t.className = 'toast';
    t.innerHTML = '&#10003; ' + msg;
    c.appendChild(t);
    setTimeout(() => t.remove(), 2500);
}

// ===== Copy to Clipboard =====
function copyCode(btn) {
    const code = btn.parentElement.querySelector('code');
    navigator.clipboard.writeText(code.innerText).then(() => showToast('Copied to clipboard!'));
}

// ===== Theme Toggle =====
function toggleTheme() {
    const html = document.documentElement;
    const curr = html.getAttribute('data-theme');
    const next = curr === 'dark' ? 'light' : 'dark';
    html.setAttribute('data-theme', next);
    document.getElementById('themeBtn').innerHTML = next === 'dark' ? '&#x263E;' : '&#x2600;';
    localStorage.setItem('theme', next);
    updateCharts();
}

// ===== Language Toggle =====
function toggleLang() {
    const body = document.body;
    const curr = body.getAttribute('data-lang');
    const next = curr === 'en' ? 'ar' : 'en';
    body.setAttribute('data-lang', next);
    document.getElementById('langBtn').textContent = next === 'en' ? 'AR' : 'EN';
    localStorage.setItem('lang', next);
}

// Init saved prefs
if (localStorage.getItem('theme')) document.documentElement.setAttribute('data-theme', localStorage.getItem('theme'));
if (localStorage.getItem('lang')) { document.body.setAttribute('data-lang', localStorage.getItem('lang')); document.getElementById('langBtn').textContent = localStorage.getItem('lang') === 'en' ? 'AR' : 'EN'; }

// ===== Search =====
const allFunctions = [
    { name: 'SUDAN_Providers()', desc: 'List all 5 data providers', tag: 'info' },
    { name: 'SUDAN_WB_Indicators(search)', desc: 'Search World Bank indicators', tag: 'search' },
    { name: 'SUDAN_WHO_Indicators(search)', desc: 'Search WHO GHO indicators', tag: 'search' },
    { name: 'SUDAN_Search(query)', desc: 'Cross-provider indicator search', tag: 'search' },
    { name: 'SUDAN_WorldBank(indicator)', desc: 'World Bank development data', tag: 'data' },
    { name: 'SUDAN_WHO(indicator)', desc: 'WHO health indicators', tag: 'data' },
    { name: 'SUDAN_FAO(dataset, element)', desc: 'FAO agricultural statistics', tag: 'data' },
    { name: 'SUDAN_UNHCR(population_type)', desc: 'UNHCR displacement data', tag: 'data' },
    { name: 'SUDAN_ILO(indicator)', desc: 'ILO labor statistics', tag: 'data' },
    { name: 'SUDAN_Boundaries(level)', desc: 'Admin boundaries as MultiPolygon GeoJSON (GADM v4.1)', tag: 'geo' },
    { name: 'SUDAN_States()', desc: '18 states with bilingual names and polygon boundaries', tag: 'geo' },
    { name: 'SUDAN_GeoCode(name)', desc: 'State name to ISO code', tag: 'geo' },
];

function openSearch() {
    document.getElementById('searchOverlay').classList.add('active');
    document.getElementById('searchInput').focus();
    filterSearch('');
}
function closeSearch() { document.getElementById('searchOverlay').classList.remove('active'); }

function filterSearch(q) {
    const results = document.getElementById('searchResults');
    const filtered = q ? allFunctions.filter(f => (f.name + f.desc).toLowerCase().includes(q.toLowerCase())) : allFunctions;
    if (filtered.length === 0) {
        results.innerHTML = '<div class="search-empty">No functions found.</div>';
        return;
    }
    results.innerHTML = filtered.map(f => `
        <div class="search-item" onclick="closeSearch()">
            <div><div class="fn-name">${f.name}</div><div class="fn-desc">${f.desc}</div></div>
            <span class="fn-tag">${f.tag}</span>
        </div>
    `).join('');
}

document.addEventListener('keydown', e => {
    if ((e.ctrlKey || e.metaKey) && e.key === 'k') { e.preventDefault(); openSearch(); }
    if (e.key === 'Escape') closeSearch();
});

// ===== Animated Counters =====
function formatNum(n, fmt) {
    if (fmt === 'pop') return (n / 1e6).toFixed(1) + 'M';
    if (fmt === 'num') return (n / 1e6).toFixed(1) + 'M';
    return n.toString();
}

const counterObserver = new IntersectionObserver(entries => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            const counters = entry.target.querySelectorAll('.counter-value');
            counters.forEach(el => {
                const target = parseInt(el.dataset.target);
                const fmt = el.dataset.format;
                const duration = 2000;
                const start = performance.now();
                function tick(now) {
                    const progress = Math.min((now - start) / duration, 1);
                    const eased = 1 - Math.pow(1 - progress, 3);
                    const current = Math.floor(eased * target);
                    el.textContent = formatNum(current, fmt);
                    if (progress < 1) requestAnimationFrame(tick);
                    else el.textContent = formatNum(target, fmt);
                }
                requestAnimationFrame(tick);
            });
            counterObserver.unobserve(entry.target);
        }
    });
}, { threshold: 0.3 });
counterObserver.observe(document.querySelector('.counters'));

// ===== Provider Status Checks =====
async function checkProviders() {
    const checks = [
        { id: 'status-wb', url: 'https://api.worldbank.org/v2/country/SDN?format=json' },
        { id: 'status-who', url: 'https://ghoapi.azureedge.net/api/WHOSIS_000001?$top=1' },
        { id: 'status-fao', url: 'https://faostatservices.fao.org/api/v1/en/data/QCL?area=276&limit=1' },
        { id: 'status-unhcr', url: 'https://api.unhcr.org/population/v1/population/?limit=1&coo=SDN&cf_type=iso' },
        { id: 'status-ilo', url: 'https://sdmx.ilo.org/rest/dataflow/ILO?format=jsondata' },
    ];
    for (const c of checks) {
        const dot = document.getElementById(c.id);
        try {
            const r = await fetch(c.url, { mode: 'no-cors', signal: AbortSignal.timeout(8000) });
            dot.className = 'status-dot online';
        } catch {
            dot.className = 'status-dot offline';
        }
    }
}
checkProviders();

// ===== Charts =====
let charts = {};
function getChartColors() {
    const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
    return {
        grid: isDark ? 'rgba(255,255,255,0.06)' : 'rgba(0,0,0,0.06)',
        text: isDark ? '#94a3b8' : '#64748b',
        accent: '#fbbf24',
        blue: '#60a5fa',
        red: '#f87171',
        green: '#34d399',
        purple: '#a78bfa',
        orange: '#fb923c',
    };
}

function createCharts() {
    const c = getChartColors();
    const defaults = { responsive: true, plugins: { legend: { labels: { color: c.text, font: { family: 'Inter' } } } }, scales: { x: { ticks: { color: c.text }, grid: { color: c.grid } }, y: { ticks: { color: c.text }, grid: { color: c.grid } } } };

    charts.pop = new Chart(document.getElementById('popChart'), {
        type: 'line',
        data: {
            labels: ['2015','2016','2017','2018','2019','2020','2021','2022','2023','2024'],
            datasets: [{
                label: 'Population (millions)',
                data: [38.65, 39.62, 40.53, 41.49, 44.44, 46.79, 48.07, 49.38, 50.04, 50.45],
                borderColor: c.accent, backgroundColor: c.accent + '20',
                fill: true, tension: 0.4, pointRadius: 4, pointBackgroundColor: c.accent,
            }]
        },
        options: { ...defaults, plugins: { ...defaults.plugins, legend: { display: false } } }
    });

    charts.refugee = new Chart(document.getElementById('refugeeChart'), {
        type: 'bar',
        data: {
            labels: ['2019','2020','2021','2022','2023','2024','2025'],
            datasets: [{
                label: 'Refugees from Sudan',
                data: [725571, 805124, 818580, 837188, 1496923, 2094373, 2466231],
                backgroundColor: [c.blue+'90',c.blue+'90',c.blue+'90',c.blue+'90',c.orange+'90',c.red+'90',c.red],
                borderRadius: 6,
            }]
        },
        options: { ...defaults, plugins: { ...defaults.plugins, legend: { display: false } } }
    });

    charts.mortality = new Chart(document.getElementById('mortalityChart'), {
        type: 'line',
        data: {
            labels: ['2000','2003','2006','2009','2012','2015','2017','2019','2021'],
            datasets: [{
                label: 'Maternal Mortality Ratio (per 100k)',
                data: [638, 567, 507, 454, 408, 370, 348, 325, 305],
                borderColor: c.green, backgroundColor: c.green + '15',
                fill: true, tension: 0.4, pointRadius: 4, pointBackgroundColor: c.green,
            }]
        },
        options: { ...defaults, plugins: { ...defaults.plugins, legend: { display: false } } }
    });

    charts.compare = new Chart(document.getElementById('compareChart'), {
        type: 'bar',
        data: {
            labels: ['Ethiopia','Egypt','Sudan','South Sudan','Chad','Eritrea','Libya','CAF'],
            datasets: [{
                label: 'Population 2024 (millions)',
                data: [125.1, 112.7, 50.4, 11.1, 18.3, 3.7, 6.9, 5.7],
                backgroundColor: [c.blue, c.green, c.accent, c.purple, c.orange, c.red, '#94a3b8', '#64748b'],
                borderRadius: 6,
            }]
        },
        options: {
            ...defaults, indexAxis: 'y',
            plugins: { ...defaults.plugins, legend: { display: false } },
        }
    });
}

function updateCharts() {
    Object.values(charts).forEach(ch => ch.destroy());
    createCharts();
}
createCharts();

// ===== Leaflet Map =====
const states = [
    { name: 'Khartoum', ar: 'الخرطوم', iso: 'SD-KH', lat: 15.55, lon: 32.53 },
    { name: 'Al Jazirah', ar: 'الجزيرة', iso: 'SD-GZ', lat: 14.88, lon: 33.53 },
    { name: 'Al Qadarif', ar: 'القضارف', iso: 'SD-GD', lat: 14.03, lon: 35.40 },
    { name: 'Kassala', ar: 'كسلا', iso: 'SD-KA', lat: 15.45, lon: 36.40 },
    { name: 'Red Sea', ar: 'البحر الأحمر', iso: 'SD-RS', lat: 19.62, lon: 37.22 },
    { name: 'River Nile', ar: 'نهر النيل', iso: 'SD-NR', lat: 17.50, lon: 33.93 },
    { name: 'Northern', ar: 'الشمالية', iso: 'SD-NO', lat: 19.50, lon: 30.22 },
    { name: 'White Nile', ar: 'النيل الأبيض', iso: 'SD-NW', lat: 13.17, lon: 32.17 },
    { name: 'Blue Nile', ar: 'النيل الأزرق', iso: 'SD-NB', lat: 11.25, lon: 34.38 },
    { name: 'Sennar', ar: 'سنار', iso: 'SD-SI', lat: 13.55, lon: 33.57 },
    { name: 'South Darfur', ar: 'جنوب دارفور', iso: 'SD-DS', lat: 11.75, lon: 24.92 },
    { name: 'North Darfur', ar: 'شمال دارفور', iso: 'SD-DN', lat: 15.77, lon: 24.90 },
    { name: 'West Darfur', ar: 'غرب دارفور', iso: 'SD-DW', lat: 12.85, lon: 23.00 },
    { name: 'Central Darfur', ar: 'وسط دارفور', iso: 'SD-DC', lat: 12.67, lon: 24.27 },
    { name: 'East Darfur', ar: 'شرق دارفور', iso: 'SD-DE', lat: 12.12, lon: 26.15 },
    { name: 'North Kordofan', ar: 'شمال كردفان', iso: 'SD-KN', lat: 13.83, lon: 29.42 },
    { name: 'South Kordofan', ar: 'جنوب كردفان', iso: 'SD-KS', lat: 11.20, lon: 29.42 },
    { name: 'West Kordofan', ar: 'غرب كردفان', iso: 'SD-KW', lat: 11.40, lon: 27.70 },
];

const map = L.map('sudan-map').setView([15.5, 30], 5);
L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org">OSM</a> &copy; <a href="https://carto.com">CARTO</a>',
    maxZoom: 12
}).addTo(map);

const goldIcon = L.divIcon({
    className: '',
    html: '<div style="width:12px;height:12px;background:#fbbf24;border-radius:50%;border:2px solid #0b0f1a;box-shadow:0 0 8px rgba(251,191,36,0.5)"></div>',
    iconSize: [12, 12], iconAnchor: [6, 6]
});

states.forEach(s => {
    L.marker([s.lat, s.lon], { icon: goldIcon })
        .addTo(map)
        .bindPopup(`<div style="font-family:Inter,sans-serif;text-align:center">
            <strong>${s.name}</strong><br>
            <span style="font-family:'Noto Kufi Arabic',sans-serif;color:#d97706">${s.ar}</span><br>
            <code style="font-size:0.8rem">${s.iso}</code><br>
            <code style="font-size:0.75rem;color:#888">SELECT SUDAN_GeoCode('${s.name}')</code>
        </div>`);
});

// ===== SQL Playground =====
const queries = [
    {
        sql: `<span class="kw">SELECT</span> * <span class="kw">FROM</span> <span class="fn">SUDAN_Providers</span>();`,
        result: `<table><thead><tr><th>provider_id</th><th>name</th><th>name_ar</th><th>description</th></tr></thead><tbody>
<tr><td>worldbank</td><td>World Bank</td><td>البنك الدولي</td><td>World Development Indicators</td></tr>
<tr><td>who</td><td>World Health Organization</td><td>منظمة الصحة العالمية</td><td>Global Health Observatory</td></tr>
<tr><td>fao</td><td>Food and Agriculture Org.</td><td>منظمة الأغذية والزراعة</td><td>FAOSTAT agricultural statistics</td></tr>
<tr><td>unhcr</td><td>UNHCR</td><td>المفوضية السامية</td><td>UN Refugee Agency data</td></tr>
<tr><td>ilo</td><td>International Labour Org.</td><td>منظمة العمل الدولية</td><td>Labour statistics</td></tr>
</tbody></table>`
    },
    {
        sql: `<span class="kw">SELECT</span> year, value <span class="kw">FROM</span> <span class="fn">SUDAN_WorldBank</span>(<span class="str">'SP.POP.TOTL'</span>)\n<span class="kw">WHERE</span> year >= <span class="num">2020</span> <span class="kw">ORDER BY</span> year;`,
        result: `<table><thead><tr><th>year</th><th>value</th></tr></thead><tbody>
<tr><td>2020</td><td>46,789,231</td></tr>
<tr><td>2021</td><td>48,066,924</td></tr>
<tr><td>2022</td><td>49,383,346</td></tr>
<tr><td>2023</td><td>50,042,791</td></tr>
<tr><td>2024</td><td>50,448,963</td></tr>
</tbody></table>`
    },
    {
        sql: `<span class="kw">SELECT</span> year, population_type, value\n<span class="kw">FROM</span> <span class="fn">SUDAN_UNHCR</span>(<span class="str">'refugees'</span>)\n<span class="kw">WHERE</span> year >= <span class="num">2022</span> <span class="kw">ORDER BY</span> year <span class="kw">DESC</span>;`,
        result: `<table><thead><tr><th>year</th><th>population_type</th><th>value</th></tr></thead><tbody>
<tr><td>2025</td><td>refugees</td><td>2,466,231</td></tr>
<tr><td>2024</td><td>refugees</td><td>2,094,373</td></tr>
<tr><td>2023</td><td>refugees</td><td>1,496,923</td></tr>
<tr><td>2022</td><td>refugees</td><td>837,188</td></tr>
</tbody></table>`
    },
    {
        sql: `<span class="kw">SELECT</span> state_name, state_name_ar, iso_code\n<span class="kw">FROM</span> <span class="fn">SUDAN_States</span>() <span class="kw">LIMIT</span> <span class="num">6</span>;`,
        result: `<table><thead><tr><th>state_name</th><th>state_name_ar</th><th>iso_code</th></tr></thead><tbody>
<tr><td>Khartoum</td><td>الخرطوم</td><td>SD-KH</td></tr>
<tr><td>Al Jazirah</td><td>الجزيرة</td><td>SD-GZ</td></tr>
<tr><td>Al Qadarif</td><td>القضارف</td><td>SD-GD</td></tr>
<tr><td>Kassala</td><td>كسلا</td><td>SD-KA</td></tr>
<tr><td>Red Sea</td><td>البحر الأحمر</td><td>SD-RS</td></tr>
<tr><td>River Nile</td><td>نهر النيل</td><td>SD-NR</td></tr>
</tbody></table>`
    },
];

let currentQuery = 0;
function loadQuery(idx, btn) {
    currentQuery = idx;
    document.querySelectorAll('.playground-tab').forEach(t => t.classList.remove('active'));
    if (btn) btn.classList.add('active');
    document.getElementById('pgEditor').innerHTML = '<code>' + queries[idx].sql + '</code>';
    document.getElementById('pgResult').innerHTML = '<span style="color:var(--text-muted)">Click "Run" to execute the query.</span>';
}
function runQuery() {
    const result = document.getElementById('pgResult');
    result.innerHTML = '<span style="color:var(--accent)">Executing...</span>';
    setTimeout(() => {
        result.innerHTML = queries[currentQuery].result;
        showToast('Query executed successfully!');
    }, 600);
}
loadQuery(0, null);
</script>

</body>
</html>
